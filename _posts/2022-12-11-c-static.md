---
layout: post
title: "static (c)"
author: "twistfatezz"
date: 2022-12-11 15:54
categories: "2022"
tags:
  - c
---
### # static for visibility
When compiling multiple files simutaneously, all functions and global variables without the static prefix have global visibility.

sub.c: non-static variable and function have global visiblility.
```c
char var = 'A'; // global variable var
// warning: implicit declaration of function 'msg' is invalid in C99
void msg(){
    printf("hello!\n");
}
static svar = 'B'
static void s_msg(){
    printf("static hello!\n");
}
```
main.c: invoke global variable and function.
```c
int main(void){
    extern char var; // extern variable must declared before use 
    printf("%c ", var)
    msg()
    return 0; // s_var & s_msg are not visible in this script
}
```
```txt
A hello
```

<hr>

### # static for variable persistency (lifespan)
Variables stored in static memory area are initialized at the beginning of the program, and they are initialized only once. The static variables can be classified into 2 categories: global variables & static variables.

Static variables can have local scope but its lifespan is as long as the program has. The following example shows that: static variable only initialized once and has a program lifespan.
```c
#include <stdio.h>

int func(void){
    // local static variable: local scope & program-equal lifespan
    static int count=4; // only initialized once as the program starts
    return count--;
}
// global varible: global scope & program-equal lifespan
int count=1; 
int main(void){
    printf("global variable\t\tlocal static variable\n");
    for(; count<=4; count++){
        // %-15d means append 15 space right
        printf("%-15d\t\t%d", count, func()); 
    }
}
```
```txt
global variable        local static variable
1                      4
2                      3
3                      2
4                      1
```

<hr>

### # static for variable initialized as 0 by default
In static storage area, all variables including global variables & static variables are all initialized as 0x00 by default, which may reduce the workdload of variable initialization.

The default initialization feature can be used in auto-ending in string creation. Take the following snippet as an example:
```c
#include <stdio.h>

int a;
int main(void){
    int i;
    static char str[10];
    printf("integar: %d; string: begin->%s<-end\n", a, str)
    return 0;
}
```
```txt
integer: 0;  string: begin-><-end
```

