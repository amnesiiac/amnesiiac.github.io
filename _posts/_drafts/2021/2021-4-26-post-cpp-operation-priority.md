---
layout: post
title: "cpp - operation priority"
subtitle: 'c++中运算符优先级整理'
author: "twistfatezz"
header-style: text
# header-img: "img/in-post/economics_1/headimg.png"
# header-mask: 0.8
comments: false 
mathjax: true
date: 2021-04-26 14:50
lang: ch 
catalog: true 
categories: cpp
tags:
  - Time 2021
  - cpp fundermentals
---

| 优先级 | 运算符 | 结合律 | 助记 
| :---: | :---: | :---: | :-:
|   1   | `::` | 从左至右     | 作用域访问
|   2   | `a++ a--` |  从左至右    | 后缀自增(减)
|   2   | `type() type{}` | 从左至右 | 函数风格转型
|   2   | `a() a[]` | 从左至右 | 函数调用 下标访问
|   2   | `.  —>` | 从左至右 | 成员访问
|   3   | `! ~` | 从右至左 | 逻辑非 按位非
|   3   | `++a --a +a -a` | 从右至左 | 前置自增(减) 正负表示符
|   3   | `(type) sizeof &a *a` | 从右至左 | c风格类型转变 取大小 取地址 指针访问
|   3   | `new new[] delete delete[]` | 从右至左 | 动态内存分配
|   4   | `.* ->*` | 从左至右 | 指向成员指针
|   5   | `a+b a/b a%b` | 从左至右 | 乘除 取模
|   6   | `a+b a-b` | 从左至右 | 加减
|   7   | `<< >>` | 从左至右 | 按位左移右移
|   8   | `< <= > >=` | 从左至右 | 大小比较
|   8.5 | `<=>` | 从左至右 | c++20 三路比较
|   9   | `== !=` | 从左至右 | 等价比较
|   10  | `a&b` | 从左至右 | 按位与
|   11  | `^` | 从左至右 | 按位异或
|   12  | `|` | 从左至右 | 按位或
|   13  | `&&` | 从左至右 | 逻辑与
|   14  | `||` | 从左至右 | 逻辑或
|   15  | `a?b:c` | 从右至左 | 三元条件
|   15  | `= += -= *= /= %=` | 从右至左 | 赋值
|   15  | `&= ^= |= <<= >>=` | 从右至左 | 赋值 
|   15  | `throw` | 从右至左 | throw运算符 
|   15  | `so_yield` | 从右至左 | c++20 yield运算符 
|   16  | `,` | 从左至右 | 逗号

### 关于上表的补充说明
`1` 结合性。拥有相同优先级的运算符以其结核性的方向与个参数绑定。
```c++
int a; int b; int c;
a=b=c;// 这个表达式按照赋值符号从右向左的结合性 可以被解释成:
((a=b)=c)// 首先从c向左结合 将c左边左右的元素都看成是一个部分 即:
(xxx)=c// 然后逐层次解析
```

`2` 优先级。优先级高的运算符相比优先级低的能够以**更紧密**的方式和实参结合。
```c++
// 在输入输出流控制中 右移运算符>>被称为流提取运算符 左移运算符<<被称为流插入运算符
// 注意 上述定义中的插入和提取是以流为主体描述的
std::cout<<a&b;// 根据运算符的优先级 这个语句被解释成
(std::cout<<a)&b// 正确 左移运算符<<的优先级要高于& 
std::cout<<(a&b)// 错误 应该按照优先级以及结合性的顺序用parenthesis划分
```
另外，关于输入输出流控制运算符的优先级参考左移动和右移动即可，因为所有类型使用友元函数对于位移运算符进行了重载。
```c++
*p++;// 根据运算符的优先级 这个语句被解释成
(*p++); // 正确 后置递增运算符++的优先级高于指针访问运算符*
(*p)++;// 错误 按照优先级使用parenthesis进行划分
```
总结：如何利用precedence图表以及结合性进行表达式的简化释义？首先按照优先级使用小括号将临近的优先结合的元素划出，然后在根据符号的结合性的方向逐步合并。

`3` 表格中没有出现`const_cast`，`static_cast`，`dynamic_cast`，`reinterpret_cast`，`typeid`，`sizeof`，`noexcept`以及`alignof`，因为他们不会有歧义。
其中`noexcept`查询表达式能否抛出异常，详见[doc](https://zh.cppreference.com/w/cpp/language/noexcept)。`typeid()`查询类型的类型信息(std::type_info)，具体详见[doc](https://zh.cppreference.com/w/cpp/language/typeid)。`alignof`查询对象的对齐要求，详见[doc](https://zh.cppreference.com/w/cpp/language/alignof)。

`4` 优先级不受运算符重载的影响，即运算符被重载了，其优先级不会改变。标准输入输出流的流操作运算符就是很好的例子，它们是由各个类别分别通过友元的方式重载获得，因此其优先级和按位左移按位右移的优先级相同。

`5` 优先级和结合性是编译时的概念，而不是运行时的概念，因此优先级和结合性与求值顺序无关，求值顺序是运行时的概念。

## Reference
> https://www.cnblogs.com/greyqz/p/operator.html

> 1 当使用inline数学公式且公式经过GFM排版之后都在同一行 使用`$...$`符号<br>
> 2 当希望数学公式单独成行或者经过GFM排版之后占用多行 应当使用`$$...$$`符号<br>
> 3 对于表示条件概率 需要表示竖线的时候`|` 应当使用`\mid` 而不是直接在键盘上打出`|` => 容易被编辑器认为是一个md制表符<br>
> 4 在md引入图片的时候 不要使用`<center>`和`</center>` 在这篇文档的编辑过程中vscode的preview插件在使用了上述符号之后 导致下一段的数学公式预览显示不正常<br>
> 5 使用md的时候 单独的两段文字上下需要空出一行<br>
> 6 想要强制换行的时候 需要使用`<br>`而不是`<enter>`<br>
> 7 特殊字符如果想要避免和md解析关键字冲突 应当使用``将关键字包含在内
