---
layout: post
title: "makefile - #1"
subtitle: '[è·Ÿæˆ‘ä¸€èµ·å†™makefile - é™ˆçš“]'
author: "twistfatezz"
header-style: text
# header-img: "img/in-post/economics_1/headimg.png"
# header-mask: 0.8
comments: false 
mathjax: false 
date: 2021-09-05 15:15
lang: ch 
catalog: true 
categories: makefile
tags:
  - Time 2021
---
### ä¸€ï¼šæ¦‚è¿°
makefileæ˜¯ç”¨äºå·¥ç¨‹è‡ªåŠ¨åŒ–ç¼–è¯‘çš„å·¥å…·ï¼Œå®ƒå…³ç³»åˆ°æ•´ä¸ªå·¥ç¨‹çš„ç¼–è¯‘è§„åˆ™ã€‚<br>
ä¸€ä¸ªå¤§çš„å·¥ç¨‹æ¶‰åŠçš„æºæ–‡ä»¶ä¸è®¡å…¶æ•°ï¼Œå¹¶ä¸”æŒ‰ç…§ç±»å‹ã€åŠŸèƒ½ã€æ¨¡å—å­˜åœ¨åœ¨ä¸åŒçš„ç›®å½•ä¸­ã€‚makefileå®šä¹‰äº†ä¸€ç³»åˆ—è§„åˆ™æ¥æŒ‡å®šï¼šå“ªäº›æ–‡ä»¶å…ˆç¼–è¯‘ã€å“ªäº›æ–‡ä»¶åç¼–è¯‘ã€å“ªäº›æ–‡ä»¶éœ€è¦é‡å¤ç¼–è¯‘(ç¼–è¯‘é¡ºåº)ï¼Œç”šè‡³æ‰§è¡Œä¸€äº›æ›´åŠ å¤æ‚çš„æ“ä½œ(makefileæœ‰ç‚¹åƒshellè„šæœ¬ä¸€æ ·ï¼Œèƒ½å¤Ÿæ‰§è¡Œæ“ä½œç³»ç»Ÿæä¾›çš„å‘½ä»¤)ã€‚

makefileå’Œmakeæ˜¯ä¸åŒçš„æ¦‚å¿µï¼Œmakeæœ¬èº«æ˜¯ä¸€ä¸ªç”¨äºè§£é‡Šmakefileä¸­æŒ‡ä»¤çš„å‘½ä»¤å·¥å…·ã€‚ä¸€èˆ¬è€Œè¨€ï¼Œå¤§å¤šæ•°IDEæä¾›äº†è¯¥å‘½ä»¤å·¥å…·ï¼Œä¾‹å¦‚Delphi(make)ï¼ŒVisual c++(nmake)ï¼ŒLinux GNU(make)ã€‚

åç»­ç« èŠ‚çš„å†…å®¹å°†ä»¥c/c++æºç å·¥ç¨‹ä¸ºåŸºç¡€(ä¼šæ¶‰åŠä¸€äº›c/c++ç¼–è¯‘å™¨ç›¸å…³çš„çŸ¥è¯†)ï¼Œå› æ­¤å¿…è¦æ—¶å¯ä»¥å‚è€ƒç›¸å…³ç¼–è¯‘å™¨æ–‡æ¡£è¿›è¡Œç†è§£ã€‚

### äºŒï¼šmakefileç®€å•ä»‹ç»
é¦–å…ˆé€šè¿‡ä¸€ä¸ªGNU makeæ‰‹å†Œæ¥è¯´æ˜makefileçš„ä¹¦å†™è§„åˆ™ã€‚

å·¥ç¨‹æ–‡ä»¶ä»‹ç»ï¼šæ•´ä¸ªå·¥ç¨‹åŒ…æ‹¬8ä¸ªæºæ–‡ä»¶(c)ï¼Œ3ä¸ªå¤´æ–‡ä»¶(h)ã€‚é€šè¿‡ç¼–å†™makefileæŒ‡å®šå·¥ç¨‹ä¸­æºæ–‡ä»¶ã€å¤´æ–‡ä»¶çš„ç¼–è¯‘è§„åˆ™æ‰€æŒ‡å®šçš„è§„åˆ™å¦‚ä¸‹ï¼š<br>
- å¦‚æœæ•´ä¸ªå·¥ç¨‹æ–‡ä»¶éƒ½æ²¡æœ‰ç¼–è¯‘è¿‡ï¼Œé‚£ä¹ˆå°±å°†æ‰€æœ‰æºæ–‡ä»¶(c)è¿›è¡Œç¼–è¯‘å¹¶é“¾æ¥ã€‚
- å¦‚æœå·¥ç¨‹ä¸­éƒ¨åˆ†æºæ–‡ä»¶è¢«ä¿®æ”¹ï¼Œé‚£ä¹ˆåªç¼–è¯‘è¢«ä¿®æ”¹çš„æºæ–‡ä»¶ï¼Œç„¶åé“¾æ¥åˆ°ç›®æ ‡ç¨‹åºå³å¯ã€‚
- å¦‚æœå·¥ç¨‹ä¸­æŸä¸ªå¤´æ–‡ä»¶è¢«ä¿®æ”¹ï¼Œåˆ™éœ€å¯¹æ‰€æœ‰å¼•ç”¨è¯¥å¤´æ–‡ä»¶çš„æºæ–‡ä»¶è¿›è¡Œç¼–è¯‘ï¼Œå¹¶é“¾æ¥åˆ°ç›®æ ‡ç¨‹åºã€‚

ä¸Šè¿°ç¼–è¯‘é“¾æ¥è§„åˆ™çœ‹èµ·æ¥æœ‰ç‚¹å¤æ‚ï¼Œä½†åªè¦å°†makefileè„šæœ¬å†™å¥½ï¼Œå®é™…ç¼–è¯‘æ—¶åªéœ€è¦é€šè¿‡"make"å‘½ä»¤å³å®Œæˆè‡ªåŠ¨åŒ–ç¼–è¯‘&é“¾æ¥ã€‚makeå‘½ä»¤å¯ä»¥è‡ªåŠ¨åœ°æ ¹æ®æ•´ä¸ªå·¥ç¨‹ä¸­æ–‡ä»¶çš„ä¿®æ”¹æƒ…å†µæ¥å†³å®šå“ªäº›æ–‡ä»¶éœ€è¦è¢«ç¼–è¯‘ï¼Œå†³å®šå®ƒä»¬çš„ç¼–è¯‘é¡ºåºï¼Œä»¥åŠè¿æ¥åˆ°ç›®æ ‡æ–‡ä»¶ã€‚

##### 1 makefileçš„åŸºæœ¬è§„åˆ™
é€šè¿‡å¦‚ä¸‹æ ·ä¾‹makefileæ–‡ä»¶æ¥äº†è§£makefileçš„æ„æˆï¼Œä»¥åŠåŸºæœ¬çš„è§„åˆ™ã€‚
```txt
target ... : prerequisites ...
    command#1
    command#2
    command#3
...
```
**[1] makefileåŸºæœ¬ç»„æˆå…ƒç´ åŠå…¶æ¦‚å¿µ** <br>
**target**è¡¨ç¤ºç›®æ ‡æ–‡ä»¶ï¼Œå¯ä»¥æ˜¯object file(ä¸­é—´ç›®æ ‡æ–‡ä»¶)ï¼Œå¯ä»¥æ˜¯å¯æ‰§è¡Œæ–‡ä»¶ï¼Œè¿˜å¯ä»¥æ˜¯ä¸€ä¸ªlabel(æ ‡ç­¾)ã€‚å…³äº"targetä¸ºlabel"çš„æƒ…å†µï¼Œåœ¨makefileåç»­"ä¼ªç›®æ ‡"ç« èŠ‚ä¸­è¿›è¡Œè§£æã€‚<br>
**prerequisites** è¡¨ç¤ºç”Ÿæˆç‰¹å®štargetæ–‡ä»¶æ‰€éœ€è¦çš„æ–‡ä»¶orç›®æ ‡ã€‚<br>
**command** è¡¨ç¤ºmakeå‘½ä»¤éœ€è¦æ‰§è¡Œå‘½ä»¤(å¯ä»¥æ˜¯ä»»æ„çš„shellå‘½ä»¤)ã€‚

**[2] makefileåŸºæœ¬å…ƒç´ ä¹‹é—´çš„ç›¸äº’ä½œç”¨ã€è”ç³»** <br>
makefileæœ¬è´¨ä¸Šå®šä¹‰äº†å·¥ç¨‹ä¸­å„ä¸ªæ–‡ä»¶ä¹‹é—´çš„ä¾èµ–å…³ç³»(targetæ–‡ä»¶ä¾èµ–äºprerequisitesæ–‡ä»¶)ï¼Œä½¿ç”¨prerequisitesç”Ÿæˆtargetæ–‡ä»¶çš„ç”Ÿæˆè§„åˆ™å®šä¹‰åœ¨commandä¸­ã€‚
æ¢ä¸€ç§è§’åº¦è¿›è¡Œè§£é‡Šï¼šå¦‚æœprerequisitesæ–‡ä»¶çš„ç‰ˆæœ¬æ¯”åˆæˆtargetæ‰€ç”¨çš„prerequisitesæ–‡ä»¶è¦æ–°ï¼Œé‚£ä¹ˆcommandä¸­ç›¸å…³å‘½ä»¤å°±ä¼šæ‰§è¡Œï¼šä½¿ç”¨prerequisitesæ–‡ä»¶æŒ‰ç…§æ—¢å®šè§„åˆ™åˆæˆæ–°çš„targetæ–‡ä»¶ã€‚

##### 2 å®Œæˆmakefileä¸‰ç§è§„åˆ™çš„å®Œæ•´ç¤ºä¾‹
**[1] makefileæ–‡ä»¶ç¤ºä¾‹**
```txt
edit : main.o kbd.o command.o display.o \
       insert.o search.o files.o utils.o
       cc -o edit main.o kbd.o command.o display.o \
                  insert.o search.o files.o util.o
main.o : main.c defs.h
        cc -c main.c
kbd.o : kbd.c defs.h command.h 
        cc -c kbd.c
command.o : command.c defs.h command.h
        cc -c command.c
display.o : display.c defs.h buffer.h
        cc -c display.c
insert.o : insert.c defs.h buffer.h
        cc -c insert.c
search.o : search.c defs.h buffer.h
        cc -c search.c
files.o : files.c defs.h buffer.h command.h
        cc -c files.c
utils.o : utils.c defs.h
        cc -c utils.c
clean :
        rm edit main.o kbd.o command.o display.o \
           insert.o search.o files.o utils.o
```
å°†ä¸Šè¿°æ–‡ä»¶ä¿å­˜æˆ"makefile"ï¼Œåœ¨ç»ˆç«¯cdåˆ°è¯¥makefileç›®å½•ä¸‹ï¼Œå¹¶æ‰§è¡Œ"make"å‘½ä»¤ï¼Œå°±å¯ä»¥ç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶editã€‚å¦‚æœæƒ³è¦åˆ é™¤å¯æ‰§è¡Œæ–‡ä»¶editä»¥åŠæ‰€æœ‰ä¸­é—´ç›®æ ‡æ–‡ä»¶ï¼Œåªéœ€è¦ç®€å•åœ°æ‰§è¡Œ"make clean"å‘½ä»¤å³å¯ã€‚

**[2] åˆ†æä¸Šè¿°makefileçš„target-prerequisites-commandæ¨¡å‹æˆå‘˜** <br>
targetæ–‡ä»¶åŒ…æ‹¬ï¼šæœ€ç»ˆç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶"edit"ï¼Œä»¥åŠæ‰€æœ‰çš„ä¸­é—´æ–‡ä»¶ "\*.o"ã€‚prerequisitesæ–‡ä»¶åŒ…æ‹¬ï¼šæ‰€æœ‰å†’å·åé¢çš„ "\*.c" æ–‡ä»¶ä»¥åŠ "\*.h" æ–‡ä»¶ã€‚

**[3] åˆ†æä¸Šè¿°makefileçš„æ–‡ä»¶ä¾èµ–å…³ç³»** <br>
makefileçš„ç¬¬ä¸€è¡Œè¯´æ˜ï¼šæœ€ç»ˆå¯æ‰§è¡Œæ–‡ä»¶"edit"çš„ç”Ÿæˆä¾èµ–é¡¹ä¸ºæ‰€æœ‰ "ä¸­é—´\*.oæ–‡ä»¶" ï¼›è€Œæ¯ä¸ª "ä¸­é—´\*.oæ–‡ä»¶" çš„ä¾èµ–é¡¹ä¸ºç›¸åº”å†’å·åé¢çš„ "\*.cæ–‡ä»¶ä»¥åŠ\*.hæ–‡ä»¶"ã€‚

**[4] å…³äºä¾èµ–æ–‡ä»¶åé¢ä¸€è¡Œå‘½ä»¤çš„è§£é‡Š** <br>
"cc -c \*.c" å®šä¹‰äº†ç”Ÿæˆä¸­é—´ç›®æ ‡æ–‡ä»¶çš„æ“ä½œç³»ç»Ÿå‘½ä»¤ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ä¾èµ–æ–‡ä»¶ä¸‹ä¸€è¡Œçš„ç¼©è¿›éœ€è¦ä½¿ç”¨"tab"è€Œä¸æ˜¯"space"ã€‚
è§£é‡Šï¼šmakefileè‡ªèº«ä¾èµ–è¯­å¥å’Œshellå‘½ä»¤ä¹‹é—´çš„åŒºåˆ«æ˜¯é€šè¿‡åˆ¤æ–­ï¼šè¡Œé¦–æ˜¯å¦ä»¥"tab"å¼€å¤´æ¥åˆ¤æ–­çš„ï¼Œé"tab"å¼€å¤´åˆ™ä¸ºmakefileè¯­å¥ï¼Œ"tab"å¼€å¤´åˆ™ä¸ºæ“ä½œç³»ç»ŸOSshellå‘½ä»¤ã€‚å› æ­¤ä¸ºäº†åŒºåˆ†è§£é‡Šä¸¤ç§"è¯­è¨€"ï¼Œç³»ç»Ÿå‘½ä»¤è¡Œä¸¥æ ¼ä½¿ç”¨"tab"ç¼©è¿›ã€‚

**[5] å…³äºmakefileæ–‡ä»¶æœ€åçš„clean** <br>
cleanå¹¶ä¸æ˜¯ä¸€ä¸ªä¸­é—´æ–‡ä»¶ï¼Œå› æ­¤ä¸æ˜¯æœ€ç»ˆå¯æ‰§è¡Œæ–‡ä»¶çš„ä¾èµ–é¡¹ï¼›å®ƒåªæ˜¯ä¸€ä¸ªmakefileç»™äºˆç‰¹å®šæ“ä½œçš„åå­—è€Œå·²(ç±»ä¼¼cè¯­è¨€çš„gotoè¯­å¥ä¸­çš„label)ã€‚<br>
cleanå‘½ä»¤åé¢å†’å·åæ²¡æœ‰å†…å®¹ï¼Œå› æ­¤makeå‘½ä»¤è§£é‡Šä¸ä¼šæŸ¥æ‰¾æ–‡ä»¶ç›¸å…³ä¾èµ–é¡¹ï¼Œè¿›è€Œä¸ä¼šæ‰§è¡Œä¸‹ä¸€è¡Œçš„ç³»ç»Ÿå‘½ä»¤ã€‚å¦‚æœéœ€è¦æ‰§è¡Œåç»­å‘½ä»¤ï¼Œåˆ™éœ€åœ¨makeå‘½ä»¤åæŒ‡å‡ºlabelåå­— =\> "make clean"ã€‚<br>
ä½¿ç”¨makeå‘½ä»¤çš„labelåŠŸèƒ½("make label")å¯ä»¥å…è®¸å®šä¹‰ä¸€äº›å¤‡ç”¨ç¼–è¯‘æµç¨‹orç¼–è¯‘æ— å…³çš„å‘½ä»¤(e.g. ç¨‹åºæ‰“åŒ…ã€ç¨‹åºå¤‡ä»½)ã€‚


## Reference
> https://blog.csdn.net/haoel/article/details/2886 <br>
> https://www.cnblogs.com/RabbitHu/p/makefile_tab.html

> 1 å½“ä½¿ç”¨inlineæ•°å­¦å…¬å¼ä¸”å…¬å¼ç»è¿‡GFMæ’ç‰ˆä¹‹åéƒ½åœ¨åŒä¸€è¡Œ ä½¿ç”¨`$...$`ç¬¦å·<br>
> 2 å½“å¸Œæœ›æ•°å­¦å…¬å¼å•ç‹¬æˆè¡Œæˆ–è€…ç»è¿‡GFMæ’ç‰ˆä¹‹åå ç”¨å¤šè¡Œ åº”å½“ä½¿ç”¨`$$...$$`ç¬¦å·<br>
> 3 å¯¹äºè¡¨ç¤ºæ¡ä»¶æ¦‚ç‡ éœ€è¦è¡¨ç¤ºç«–çº¿çš„æ—¶å€™`|` åº”å½“ä½¿ç”¨`\mid` è€Œä¸æ˜¯ç›´æ¥åœ¨é”®ç›˜ä¸Šæ‰“å‡º`|` => å®¹æ˜“è¢«ç¼–è¾‘å™¨è®¤ä¸ºæ˜¯ä¸€ä¸ªmdåˆ¶è¡¨ç¬¦<br>
> 4 åœ¨mdå¼•å…¥å›¾ç‰‡çš„æ—¶å€™ ä¸è¦ä½¿ç”¨`<center>`å’Œ`</center>` åœ¨è¿™ç¯‡æ–‡æ¡£çš„ç¼–è¾‘è¿‡ç¨‹ä¸­vscodeçš„previewæ’ä»¶åœ¨ä½¿ç”¨äº†ä¸Šè¿°ç¬¦å·ä¹‹å å¯¼è‡´ä¸‹ä¸€æ®µçš„æ•°å­¦å…¬å¼é¢„è§ˆæ˜¾ç¤ºä¸æ­£å¸¸<br>
> 5 ä½¿ç”¨mdçš„æ—¶å€™ å•ç‹¬çš„ä¸¤æ®µæ–‡å­—ä¸Šä¸‹éœ€è¦ç©ºå‡ºä¸€è¡Œ<br>
> 6 æƒ³è¦å¼ºåˆ¶æ¢è¡Œçš„æ—¶å€™ éœ€è¦ä½¿ç”¨`<br>`è€Œä¸æ˜¯`<enter>`<br>
> 7 ç‰¹æ®Šå­—ç¬¦å¦‚æœæƒ³è¦é¿å…å’Œmdè§£æå…³é”®å­—å†²çª åº”å½“ä½¿ç”¨``å°†å…³é”®å­—åŒ…å«åœ¨å†… <br>
> 8 `<center><img src="/img/in-post/economics_4/xxx.png" width="60%"></center>` <br>
> 9 ä½¿ç”¨htmlè®¾ç½®å›¾ç‰‡æ–‡å­—ç¯ç»•æ–¹å¼: <br>
    `<div>` <br>
        `<img src="/img_path" align="left" width="40%" hspace="" vspace=""/>` <br>
        `<p>paragraph1 around the picture</p>` <br>
        `<p>paragraph2 around the picture</p>` <br>
        `<p>paragraph3 around the picture</p>` <br>
    `</div>` <br>
> 10 `<font style="color:red; font-weight:bold">åŠ ç²—è“è‰²</font>`ç”¨æ¥è®¾ç½®å­—ä½“é¢œè‰² <br>
> é—®é¢˜è„šæ³¨: ### ???problemğŸ˜«problem???
